Fix applied by Dave
Additional fix by Eve
frank's change
